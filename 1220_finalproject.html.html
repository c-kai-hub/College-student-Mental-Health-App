<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mental Health App - Fixed Flow</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        /* ================= CSS VARIABLES ================= */
        :root {
            font-family: 'Inter', sans-serif;
            /* Branding Colors */
            --anxiety-indigo: #4f46e5;
            --stress-sage: #74b8a5;
            --dep-yellow: #fbbf24;
            
            /* --- Default Theme: ANXIETY (Dark) --- */
            --bg-body: #000000;
            --bg-frame: #050505;
            --bg-card: #1e1b4b; 
            --bg-card-hover: #312e81;
            --text-main: #e0e7ff; 
            --text-sub: #818cf8; 
            --accent: #6366f1;
            --border: #312e81;
            --nav-bg: rgba(5, 5, 5, 0.95);
        }

        /* --- Theme: STRESS (Light Green) --- */
        [data-theme="stress"] {
            --bg-body: #f1f5f9;
            --bg-frame: #ffffff;
            --bg-card: #f8fafc;
            --bg-card-hover: #f0fdf4;
            --text-main: #334155;
            --text-sub: #64748b;
            --accent: #74b8a5;
            --border: #e2e8f0;
            --nav-bg: rgba(255, 255, 255, 0.95);
        }

        /* --- Theme: DEPRESSION (Warm Yellow) --- */
        [data-theme="depression"] {
            --bg-body: #fffbeb;
            --bg-frame: #ffffff;
            --bg-card: #ffffff;
            --bg-card-hover: #fffdf5;
            --text-main: #451a03;
            --text-sub: #d97706;
            --accent: #fbbf24;
            --border: #fde68a;
            --nav-bg: rgba(255, 255, 255, 0.95);
        }
        
        body {
            background-color: #f1f5f9; /* Browser background */
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            color: var(--text-main);
            transition: background-color 0.5s ease;
        }

        /* Phone Container */
        .phone-frame {
            width: 375px;
            height: 812px;
            background-color: #ffffff; /* Start with white for onboarding */
            border-radius: 40px;
            box-shadow: 0 30px 60px -12px rgba(0, 0, 0, 0.25);
            position: relative;
            overflow: hidden;
            border: 8px solid #1a1a1a;
            transition: background-color 0.5s ease, color 0.5s ease;
        }

        /* ================== STAGE 0: SPLASH VISUAL ================== */
        #stage-splash { background-color: #050505; color: white; z-index: 50; }
        
        .orb-container { position: relative; width: 200px; height: 200px; display: flex; justify-content: center; align-items: center; }
        .orb { position: absolute; width: 120px; height: 120px; border-radius: 50%; filter: blur(40px); opacity: 0.8; animation: morphColor 8s infinite alternate, breathe 4s infinite ease-in-out; }
        .orb-core { position: relative; width: 10px; height: 10px; background: white; border-radius: 50%; box-shadow: 0 0 20px rgba(255,255,255,0.8); z-index: 10; }

        @keyframes morphColor {
            0% { background: var(--anxiety-indigo); transform: scale(1) translate(0,0); }
            50% { background: var(--stress-sage); transform: scale(1.1) translate(10px, -10px); }
            100% { background: var(--dep-yellow); transform: scale(0.95) translate(-5px, 10px); }
        }
        @keyframes breathe { 0%, 100% { transform: scale(1); opacity: 0.6; } 50% { transform: scale(1.3); opacity: 0.9; } }

        .glass-btn { background: rgba(255, 255, 255, 0.1); backdrop-filter: blur(10px); border: 1px solid rgba(255, 255, 255, 0.2); color: white; padding: 16px 32px; border-radius: 30px; font-size: 14px; font-weight: 600; letter-spacing: 0.1em; text-transform: uppercase; transition: all 0.3s; width: 80%; text-align: center; }
        .glass-btn:hover { background: rgba(255, 255, 255, 0.2); transform: translateY(-2px); }

        /* ================== UI COMPONENTS ================== */
        .min-input { width: 100%; padding: 16px; border: 1px solid #e2e8f0; border-radius: 12px; outline: none; font-size: 14px; margin-bottom: 12px; color: #333; }
        .min-btn { width: 100%; padding: 16px; background-color: #1a1a1a; color: white; border-radius: 12px; font-weight: 600; font-size: 14px; letter-spacing: 0.05em; text-transform: uppercase; transition: all 0.2s; }
        .min-btn:hover { opacity: 0.9; }
        
        /* Chat Bubbles */
        .chat-bubble-ai { background-color: #f1f5f9; padding: 16px 20px; border-radius: 20px; border-bottom-left-radius: 4px; max-width: 85%; font-size: 15px; line-height: 1.5; color: #334155; margin-bottom: 16px; align-self: flex-start; }
        .chat-bubble-user { background-color: #1a1a1a; color: white; padding: 12px 20px; border-radius: 20px; border-bottom-right-radius: 4px; max-width: 80%; font-size: 14px; margin-bottom: 16px; align-self: flex-end; text-align: right; }

        /* Result Cards */
        .result-card { border-radius: 24px; padding: 24px; transition: all 0.3s; color: white; margin-bottom: 24px; }
        .secondary-card { background: #ffffff; border: 1px solid #e2e8f0; padding: 16px; border-radius: 16px; display: flex; justify-content: space-between; items-center; margin-bottom: 12px; cursor: pointer; transition: bg 0.2s; color: #333; }
        .secondary-card:hover { background-color: #f8fafc; }

        /* Main App Cards */
        .min-card { background-color: var(--bg-card); border: 1px solid var(--border); border-radius: 20px; padding: 24px; transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); }
        .min-card:hover { background-color: var(--bg-card-hover); transform: translateY(-2px); }
        .glass-nav { background: var(--nav-bg); backdrop-filter: blur(12px); border-top: 1px solid var(--border); }
        .check-box { width: 20px; height: 20px; border: 2px solid var(--text-sub); border-radius: 6px; display: flex; align-items: center; justify-content: center; transition: all 0.2s; }
        .checked .check-box { background-color: var(--accent); border-color: var(--accent); }

        /* Utilities */
        .fade-out { animation: fadeOut 0.6s forwards; }
        .fade-in { animation: fadeIn 0.8s forwards; opacity: 0; }
        @keyframes fadeOut { to { opacity: 0; visibility: hidden; } }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        
        .typing-dot { width: 6px; height: 6px; background: #cbd5e1; border-radius: 50%; animation: typing 1.4s infinite both; }
        .typing-dot:nth-child(1) { animation-delay: 0s; }
        .typing-dot:nth-child(2) { animation-delay: 0.2s; }
        .typing-dot:nth-child(3) { animation-delay: 0.4s; }
        @keyframes typing { 0%, 80%, 100% { opacity: 0; } 40% { opacity: 1; } }

        .hidden { display: none !important; }
        .hide-scrollbar::-webkit-scrollbar { display: none; }
    </style>
</head>
<body>

    <div class="phone-frame flex flex-col" id="app-container">

        <div id="stage-splash" class="absolute inset-0 flex flex-col justify-between items-center py-16 px-6">
            <div class="mt-8 text-center opacity-80"><span class="text-[10px] font-bold tracking-[0.4em] uppercase">Mental Health App</span></div>
            <div class="orb-container"><div class="orb"></div><div class="orb" style="animation-delay: -2s; opacity: 0.5;"></div><div class="orb-core"></div></div>
            <div class="text-center z-10">
                <h1 class="text-4xl font-light tracking-tight mb-2">Center.</h1>
                <p class="text-sm text-gray-400 font-light">Find your rhythm in the chaos.</p>
            </div>
            <button onclick="nextStage('stage-splash', 'stage-welcome')" class="glass-btn">Get Started</button>
        </div>

        <div id="stage-welcome" class="hidden absolute inset-0 bg-white flex flex-col p-8 fade-in text-slate-800">
            <div class="flex-1 flex flex-col justify-center">
                <h2 class="text-2xl font-bold mb-6">Create Account</h2>
                <div class="space-y-4">
                    <input type="text" placeholder="Username" class="min-input">
                    <input type="email" placeholder="Student Email" class="min-input">
                    <input type="password" placeholder="Password" class="min-input">
                </div>
                <p class="text-xs text-slate-400 mt-4 leading-relaxed">By continuing, you agree to let our AI assist you in finding the right mental health plan.</p>
            </div>
            <button onclick="nextStage('stage-welcome', 'stage-chat')" class="min-btn mb-4">Continue</button>
        </div>

        <div id="stage-chat" class="hidden absolute inset-0 bg-white flex flex-col pt-12 pb-6 px-6 fade-in">
            <div class="flex items-center justify-between mb-8 border-b border-slate-100 pb-4">
                <div class="flex items-center gap-3">
                    <div class="w-8 h-8 rounded-full bg-slate-100 flex items-center justify-center text-[10px] font-bold text-slate-600">AI</div>
                    <span class="text-xs font-bold uppercase tracking-widest text-slate-400">Assessment</span>
                </div>
                <span class="text-xs text-slate-300">Skip</span>
            </div>
            <div id="chat-container" class="flex-1 overflow-y-auto flex flex-col">
                <div class="chat-bubble-ai fade-in" style="animation-delay: 0.2s">Hello. Before we begin, I'd like to know how you are feeling right now.</div>
                <div id="user-response-trigger" class="chat-bubble-user cursor-pointer opacity-0" style="animation: fadeIn 0.5s forwards 1.2s" onclick="simulateChat()">I feel overwhelmed and anxious about my grades.</div>
                <div id="ai-typing" class="chat-bubble-ai hidden w-16"><div class="flex gap-1 justify-center"><div class="typing-dot"></div><div class="typing-dot"></div><div class="typing-dot"></div></div></div>
            </div>
        </div>

        <div id="stage-analyzing" class="hidden absolute inset-0 bg-white z-20 flex flex-col items-center justify-center fade-in">
            <div class="orb-container" style="transform: scale(0.5);"><div class="orb"></div><div class="orb-core"></div></div>
            <h2 class="text-lg font-bold mt-4 mb-1 text-slate-800">Analyzing...</h2>
            <p class="text-xs text-slate-400">Finding the best module for you.</p>
        </div>

        <div id="stage-results" class="hidden absolute inset-0 bg-white flex flex-col pt-12 px-6 fade-in overflow-y-auto">
            <h1 class="text-xl font-bold mb-2 text-slate-800">Your Plan</h1>
            <p class="text-xs text-slate-400 mb-6">Based on your input, we recommend:</p>

            <div class="result-card shadow-xl shadow-indigo-500/20 cursor-pointer hover:scale-[1.02]" style="background-color: #1e1b4b;" onclick="enterApp('anxiety')">
                <div class="flex justify-between items-start mb-4">
                    <span class="bg-indigo-500/30 text-indigo-100 px-3 py-1 rounded-full text-[10px] font-bold uppercase tracking-wider">Best Match</span>
                    <span class="text-2xl">üåä</span>
                </div>
                <h2 class="text-2xl font-bold mb-2">Anxiety Support</h2>
                <p class="text-xs text-indigo-200 opacity-80 leading-relaxed mb-6">Focus on <strong>Grounding Rituals</strong> and <strong>Structure</strong> to help you regain control.</p>
                <div class="flex items-center gap-2 text-xs font-bold text-indigo-300 uppercase tracking-widest"><span>Enter Module</span><span>‚Üí</span></div>
            </div>

            <div class="secondary-card" onclick="enterApp('stress')">
                <div class="flex items-center gap-4">
                    <div class="w-10 h-10 rounded-full bg-[#f0fdf4] flex items-center justify-center text-[#74b8a5]">üåø</div>
                    <div><h3 class="text-sm font-bold text-slate-700">Stress Relief</h3><p class="text-[10px] text-slate-400">For focus & deadlines.</p></div>
                </div>
                <span class="text-slate-300">‚Üí</span>
            </div>

            <div class="secondary-card" onclick="enterApp('depression')">
                <div class="flex items-center gap-4">
                    <div class="w-10 h-10 rounded-full bg-[#fffbeb] flex items-center justify-center text-[#fbbf24]">‚òÄÔ∏è</div>
                    <div><h3 class="text-sm font-bold text-slate-700">Warm Embrace</h3><p class="text-[10px] text-slate-400">For low energy days.</p></div>
                </div>
                <span class="text-slate-300">‚Üí</span>
            </div>
        </div>

        <div id="stage-main-app" class="hidden absolute inset-0 flex flex-col z-10" style="background-color: var(--bg-frame); color: var(--text-main);">
            <div class="px-6 pt-14 pb-6 flex justify-between items-end z-10">
                <div>
                    <span id="header-date" class="text-[10px] font-bold tracking-[0.2em] opacity-60 uppercase mb-2 block" style="color: var(--text-sub)">Dec 20</span>
                    <h1 id="header-title" class="text-3xl font-bold tracking-tight">Morning.</h1>
                </div>
                <div class="w-10 h-10 rounded-full border-2 border-dashed opacity-50 flex items-center justify-center" style="border-color: var(--text-sub)">
                    <span class="text-xs font-bold">U</span>
                </div>
            </div>

            <div id="content-area" class="flex-1 overflow-y-auto hide-scrollbar pb-28 px-6 relative"></div>

            <div class="glass-nav absolute bottom-0 w-full h-24 flex justify-around items-start pt-5 px-4 z-50">
                <button onclick="switchTab('today')" class="w-12 flex flex-col items-center gap-1 opacity-50 hover:opacity-100 transition"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect><line x1="16" y1="2" x2="16" y2="6"></line><line x1="8" y1="2" x2="8" y2="6"></line><line x1="3" y1="10" x2="21" y2="10"></line></svg><span class="text-[9px] font-bold tracking-widest mt-1">TODAY</span></button>
                <button onclick="switchTab('chat')" class="w-12 flex flex-col items-center gap-1 opacity-50 hover:opacity-100 transition"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path></svg><span class="text-[9px] font-bold tracking-widest mt-1">CHAT</span></button>
                <button onclick="switchTab('recharge')" class="relative -top-6 w-16 h-16 rounded-full flex items-center justify-center shadow-lg transition transform hover:scale-105" style="background-color: var(--accent); color: var(--bg-frame);"><svg width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="M13 2L3 14h9l-1 8 10-12h-9l1-8z"></path></svg></button>
                <button onclick="switchTab('plan')" class="w-12 flex flex-col items-center gap-1 opacity-50 hover:opacity-100 transition"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect><line x1="3" y1="9" x2="21" y2="9"></line><line x1="9" y1="21" x2="9" y2="9"></line></svg><span class="text-[9px] font-bold tracking-widest mt-1">PLAN</span></button>
                <button onclick="switchTab('profile')" class="w-12 flex flex-col items-center gap-1 opacity-50 hover:opacity-100 transition"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path><circle cx="12" cy="7" r="4"></circle></svg><span class="text-[9px] font-bold tracking-widest mt-1">ME</span></button>
            </div>
        </div>

    </div>

    <script>
        // ================= LOGIC =================
        const contentData = {
            anxiety: { 
                title: "Slow down.",
                today: `<div class="fade-in space-y-6"><div class="min-card cursor-pointer group" onclick="toggleCheck(this)"><div class="flex justify-between items-start mb-6"><span class="text-[10px] font-bold tracking-widest opacity-60">RITUAL</span><div class="w-2 h-2 rounded-full bg-indigo-500 animate-pulse"></div></div><div class="flex items-center gap-5"><div class="check-box group-hover:border-indigo-400"><svg class="w-3 h-3 text-white opacity-0 check-icon transition" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="4"><polyline points="20 6 9 17 4 12"></polyline></svg></div><div><h3 class="text-xl font-medium line-through-target">Drink warm water</h3><p class="text-xs text-indigo-300 mt-1 opacity-60">Focus on the temperature.</p></div></div></div><div class="flex items-center gap-4 px-2 py-4 rounded-2xl border border-dashed border-indigo-900/50 hover:bg-indigo-900/20 transition cursor-pointer" onclick="switchTab('recharge')"><span class="text-2xl">üßò</span><div><p class="text-sm font-semibold text-indigo-100">Feeling overwhelmed?</p><p class="text-xs text-indigo-400">Tap to breathe.</p></div></div></div>`,
                recharge: `<div class="fade-in text-center pt-8 space-y-8"><div><h2 class="text-2xl font-bold text-white">Deep Calm</h2><p class="text-sm text-indigo-300 opacity-60">Return to your center.</p></div><div class="min-card py-16 flex flex-col items-center justify-center cursor-pointer hover:border-indigo-400 transition" onclick="alert('Inhale... Exhale...')"><div class="w-32 h-32 rounded-full bg-indigo-900/40 flex items-center justify-center relative"><div class="w-4 h-4 bg-indigo-400 rounded-full shadow-[0_0_20px_rgba(99,102,241,0.6)] animate-pulse"></div></div><h3 class="text-xs font-bold tracking-[0.3em] text-indigo-200 mt-8 uppercase">Breathe</h3></div><div class="text-left space-y-3"><h4 class="text-xs font-bold text-indigo-400 uppercase tracking-widest pl-2">Micro Moves</h4><div class="min-card py-4 flex justify-between items-center hover:bg-indigo-900/50"><span class="text-sm font-medium">Ankle Rotations</span><span class="text-xs text-indigo-400 bg-indigo-950 px-2 py-1 rounded">10x</span></div></div></div>`,
                plan: `<div class="fade-in space-y-6"><h2 class="text-lg font-semibold text-white">Structure</h2><div class="relative pl-6 border-l border-indigo-900 space-y-8"><div><span class="text-[10px] font-mono text-indigo-400 mb-3 block">14:00 - 15:00</span><div class="min-card border-l-4 border-l-indigo-500"><h3 class="text-base font-medium mb-4">Library Session</h3><div class="space-y-3"><div class="flex items-center gap-3 opacity-70 hover:opacity-100 cursor-pointer"><div class="w-4 h-4 border border-indigo-500 rounded-sm"></div><span class="text-sm">Pack water bottle</span></div><div class="flex items-center gap-3 opacity-70 hover:opacity-100 cursor-pointer"><div class="w-4 h-4 border border-indigo-500 rounded-sm"></div><span class="text-sm">Put on headphones</span></div></div></div></div></div></div>`
            },
            stress: { 
                title: "Focus & Flow.",
                today: `<div class="fade-in space-y-8"><div class="min-card py-12 px-8 text-center border-0 shadow-sm relative overflow-hidden"><div class="absolute top-0 left-0 w-full h-1 bg-[#74b8a5]"></div><span class="text-[10px] font-bold tracking-widest text-[#74b8a5] uppercase mb-4 block">Priority One</span><h2 class="text-3xl font-bold text-slate-800 mb-2">Finalize Report</h2><p class="text-xs text-slate-400 font-mono mt-4">DEADLINE: 5H 20M</p></div><p class="text-center text-[10px] text-slate-400 tracking-wide font-medium">Everything else is hidden.</p></div>`,
                recharge: `<div class="fade-in space-y-6 pt-4"><div class="text-center mb-4"><h2 class="text-xl font-bold text-slate-700">Brain Dump</h2><p class="text-sm text-slate-400">Clear your mind.</p></div><div class="min-card p-0 overflow-hidden shadow-sm border-[#e2e8f0]"><textarea id="dump-area" class="w-full bg-white p-6 border-none outline-none resize-none h-40 text-sm text-slate-600 placeholder-slate-300 leading-relaxed" placeholder="Type all your worries here..."></textarea><div class="bg-[#f8fafc] p-3 flex justify-end border-t border-[#e2e8f0]"><button onclick="document.getElementById('dump-area').value = ''; alert('Cleared');" class="text-xs font-bold text-[#74b8a5] hover:text-[#5fa390] uppercase tracking-wider px-4 py-2 hover:bg-[#effaf6] rounded-lg transition">Clear & Forget</button></div></div></div>`,
                plan: `<div class="fade-in space-y-4"><h2 class="text-lg font-semibold text-slate-700 mb-4">Time Blocks</h2><div class="space-y-4"><div class="min-card flex justify-between items-center py-5 border-l-4 border-l-[#74b8a5] shadow-sm bg-white"><div><p class="text-sm font-bold text-slate-700">13:00 - 15:00</p><p class="text-xs text-slate-400">Deep Work</p></div></div><div class="py-2 flex justify-center items-center gap-2"><span class="text-[10px] font-mono uppercase tracking-widest text-[#74b8a5] bg-[#d1fae5] px-3 py-1 rounded-full">Buffer Time</span></div><div class="min-card flex justify-between items-center py-5 border-l-4 border-l-slate-200 bg-white opacity-60"><div><p class="text-sm font-bold text-slate-700">15:30 - 16:30</p><p class="text-xs text-slate-400">Team Sync</p></div></div></div></div>`
            },
            depression: { 
                title: "Hello, Sunshine.",
                today: `<div class="fade-in space-y-6"><div class="min-card p-0 overflow-hidden border-0 shadow-lg shadow-orange-100/50"><div class="h-36 bg-[#fffbeb] flex items-center justify-center relative"><div class="absolute inset-0 bg-gradient-to-tr from-[#fef3c7] to-white opacity-50"></div><span class="text-4xl relative z-10 drop-shadow-sm">üçú</span></div><div class="p-6 bg-white"><h3 class="text-lg font-bold text-[#78350f]">Warm Comfort Food</h3><p class="text-xs text-[#b45309] mt-2 leading-relaxed">There's a ramen place nearby. Want to try?</p></div></div><div class="min-card flex justify-between items-center bg-white border border-amber-100 shadow-sm"><span class="text-sm font-bold text-[#78350f] opacity-80">Mood Check</span><div class="flex gap-4"><button class="hover:scale-125 transition text-lg">‚òÅÔ∏è</button><button class="hover:scale-125 transition text-lg">‚õÖ</button><button class="hover:scale-125 transition text-lg">‚òÄÔ∏è</button></div></div></div>`,
                recharge: `<div class="fade-in text-center pt-6 space-y-8"><div><h2 class="text-xl font-bold text-[#78350f]">Collect Sparks</h2><p class="text-sm text-amber-600 opacity-70">Tiny moments of light.</p></div><div class="min-card py-12 border-2 border-dashed border-[#fcd34d] bg-[#fffbeb] cursor-pointer hover:bg-[#fef3c7] transition group"><div class="text-3xl mb-4 group-hover:scale-110 transition">üì∑</div><h3 class="text-sm font-bold text-[#78350f] uppercase tracking-wide">Snap the Sky</h3><p class="text-xs text-amber-600 mt-2">Look up. What shape are the clouds?</p></div><div class="text-left"><h4 class="text-xs font-bold text-amber-400 ml-1 mb-3 uppercase tracking-widest">Sanctuaries</h4><div class="flex gap-3 overflow-x-auto hide-scrollbar pb-2"><div class="min-card min-w-[110px] h-24 flex flex-col justify-end bg-[#fffbeb] border-amber-100"><span class="text-xs font-bold text-[#78350f]">Park Bench</span></div><div class="min-card min-w-[110px] h-24 flex flex-col justify-end bg-[#fffbeb] border-amber-100"><span class="text-xs font-bold text-[#78350f]">Cat Cafe</span></div></div></div></div>`,
                plan: `<div class="fade-in space-y-6"><h2 class="text-lg font-semibold text-[#78350f] mb-4">Life Log</h2><div class="relative pl-4 space-y-8"><div class="flex gap-4"><div class="flex flex-col items-center pt-1"><div class="w-3 h-3 rounded-full bg-[#fbbf24] shadow-sm"></div><div class="w-[2px] h-full bg-[#fef3c7] mt-1"></div></div><div class="min-card flex-1 py-4 px-5 bg-white border-amber-100 shadow-sm"><div class="flex justify-between items-baseline mb-1"><p class="text-sm font-bold text-[#78350f]">Lunch</p><span class="text-[10px] text-amber-400 font-bold">12:30</span></div><p class="text-xs text-amber-800 opacity-80">Had a warm egg tart.</p></div></div></div></div>`
            }
        };

        let currentTheme = 'anxiety';
        let currentTab = 'today';

        function nextStage(currentId, nextId) {
            const current = document.getElementById(currentId);
            const next = document.getElementById(nextId);
            current.classList.add('fade-out');
            setTimeout(() => {
                current.classList.add('hidden');
                current.classList.remove('fade-out');
                next.classList.remove('hidden');
            }, 500);
        }

        function simulateChat() {
            const container = document.getElementById('chat-container');
            const typing = document.getElementById('ai-typing');
            
            typing.classList.remove('hidden');
            container.scrollTop = container.scrollHeight;

            setTimeout(() => {
                typing.classList.add('hidden');
                const response = document.createElement('div');
                response.className = 'chat-bubble-ai fade-in';
                response.innerHTML = "I understand. Prioritizing structure can help reduce that anxiety. Let me formulate a plan for you.";
                container.insertBefore(response, typing);
                container.scrollTop = container.scrollHeight;

                setTimeout(() => {
                    nextStage('stage-chat', 'stage-analyzing');
                    setTimeout(() => {
                        nextStage('stage-analyzing', 'stage-results');
                    }, 2500);
                }, 2000);
            }, 1500);
        }

        function enterApp(theme) {
            const results = document.getElementById('stage-results');
            const mainApp = document.getElementById('stage-main-app');
            results.classList.add('fade-out');
            setTimeout(() => {
                results.classList.add('hidden');
                mainApp.classList.remove('hidden');
                mainApp.classList.add('fade-in');
                setTheme(theme);
            }, 500);
        }

        function setTheme(theme) {
            currentTheme = theme;
            document.documentElement.setAttribute('data-theme', theme);
            const frame = document.querySelector('.phone-frame');
            if(theme === 'anxiety') { frame.style.backgroundColor = '#050505'; } 
            else { frame.style.backgroundColor = '#ffffff'; }
            document.getElementById('header-title').innerText = contentData[theme].title;
            switchTab('today');
        }

        function switchTab(tab) {
            currentTab = tab;
            const contentArea = document.getElementById('content-area');
            if (tab === 'chat') { contentArea.innerHTML = getChatTemplate(); } 
            else if (tab === 'profile') { contentArea.innerHTML = getProfileTemplate(); } 
            else { contentArea.innerHTML = contentData[currentTheme][tab]; }
        }

        function getChatTemplate() {
            return `<div class="fade-in flex flex-col h-full pt-4"><div class="flex-1 space-y-6"><div class="flex gap-3"><div class="w-8 h-8 rounded-full border border-current opacity-30 flex items-center justify-center text-[10px]">AI</div><div class="min-card py-3 px-5 max-w-[85%] rounded-tl-none border-0" style="background-color: var(--bg-card); border: 1px solid var(--border)"><p class="text-sm font-medium opacity-90">Doing okay? Want to adjust the plan?</p></div></div></div><div class="flex items-center gap-3 mt-4 opacity-60"><input type="text" placeholder="Type a message..." class="bg-transparent flex-1 py-3 text-sm outline-none border-b border-current font-medium"><button class="text-[10px] uppercase font-bold tracking-widest px-3 py-1 rounded border border-current hover:bg-current hover:text-[var(--bg-body)] transition">SEND</button></div></div>`;
        }

        function getProfileTemplate() {
            return `<div class="fade-in text-center space-y-8 pt-10"><div class="w-24 h-24 rounded-full border-2 border-dashed mx-auto flex items-center justify-center text-3xl font-light" style="border-color: var(--text-sub)">U</div><div><h2 class="text-xl font-bold">User_01</h2><p class="text-xs opacity-50 mt-1">Assessment Complete</p></div><div class="grid grid-cols-2 gap-4"><div class="min-card text-center"><p class="text-2xl font-bold">5</p><p class="text-[10px] font-bold uppercase tracking-widest opacity-40 mt-1">Streak</p></div><div class="min-card text-center"><p class="text-2xl font-bold">12</p><p class="text-[10px] font-bold uppercase tracking-widest opacity-40 mt-1">Sessions</p></div></div><button class="w-full min-card flex justify-between items-center opacity-60 hover:opacity-100 transition" onclick="location.reload()"><span class="text-xs font-bold uppercase tracking-widest">Restart Prototype</span><span>‚Üª</span></button></div>`;
        }

        function toggleCheck(el) {
            el.classList.toggle('checked');
            const title = el.querySelector('.line-through-target');
            const icon = el.querySelector('.check-icon');
            if(el.classList.contains('checked')){
                title.style.textDecoration = 'line-through';
                title.style.opacity = '0.4';
                icon.style.opacity = '1';
            } else {
                title.style.textDecoration = 'none';
                title.style.opacity = '1';
                icon.style.opacity = '0';
            }
        }
    </script>
</body>
</html>